<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Part 12 ‚Äî 20th-Century Turns: Phenomenology ‚Ä¢ Pragmatism ‚Ä¢ Analytic ‚Ä¢ Language & Mind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- React UMD + Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Tailwind (runtime) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Inter font (optional) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
  <style>
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; }
    .gradient-header { background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 50%, #0ea5e9 100%); }
    .progress-bar { transition: width .3s ease; }
    @media print {
      body * { visibility: hidden; }
      #printable, #printable * { visibility: visible; }
      #printable { position: absolute; left: 0; top: 0; width: 100%; }
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // ---------- Utilities ----------
    const STORAGE_KEY = "part12_progress_v1";

    const generateSessionId = () => {
      const d = new Date();
      const pad = (n) => String(n).padStart(2, "0");
      return [
        "P12",
        d.getFullYear(),
        pad(d.getMonth()+1),
        pad(d.getDate()),
        "-",
        pad(d.getHours()),
        pad(d.getMinutes()),
        pad(d.getSeconds()),
        "-",
        Math.random().toString(36).slice(2, 8).toUpperCase()
      ].join("");
    };

    const masteryFromPercent = (pct) => {
      if (pct >= 90) return "mastered";
      if (pct >= 80) return "proficient";
      if (pct >= 60) return "developing";
      return "novice";
    };

    const masteryBadge = (level) => {
      const map = {
        mastered: { text: "‚≠ê Mastered", cls: "bg-blue-100 text-blue-800" },
        proficient: { text: "‚úì Proficient", cls: "bg-green-100 text-green-800" },
        developing: { text: "üîÑ Developing", cls: "bg-yellow-100 text-yellow-800" },
        novice: { text: "‚≠ï Novice", cls: "bg-red-100 text-red-800" },
        "not-started": { text: "‚≠ï Not Started", cls: "bg-gray-100 text-gray-700" }
      };
      return map[level] ?? map["not-started"];
    };

    // ---------- Content Data ----------
    const SECTIONS = [
      { id: "intro", label: "Introduction", icon: "üìö" },
      { id: "phenomenology", label: "Phenomenology", icon: "üîé" },
      { id: "pragmatism", label: "Pragmatism", icon: "üõ†Ô∏è" },
      { id: "analytic", label: "Analytic / Language", icon: "üß†" },
      { id: "mind", label: "Language & Mind", icon: "üó£Ô∏è" },
      { id: "studio", label: "Claim ‚Üí Workflow Studio", icon: "üèóÔ∏è" },
      { id: "assessment", label: "Assessment", icon: "‚úÖ" },
      { id: "completion", label: "Completion Doc", icon: "üìÑ" }
    ];

    const QUIZ = [
      {
        id: "q1",
        prompt: "Phenomenology‚Äôs epoch√© primarily trains which capability?",
        options: [
          { id: "A", text: "Inventing new theories" },
          { id: "B", text: "Bracketing assumptions to describe what is given", correct: true },
          { id: "C", text: "Measuring behavioral consequences" },
          { id: "D", text: "Formal proof construction" }
        ],
        explanation: "Epoch√© suspends presuppositions to describe the structures of experience."
      },
      {
        id: "q2",
        prompt: "Pragmatism‚Äôs definition of meaning focuses on:",
        options: [
          { id: "A", text: "The elegance of a proof" },
          { id: "B", text: "The antiquity of a concept" },
          { id: "C", text: "The practical bearings and consequences in inquiry", correct: true },
          { id: "D", text: "The speaker‚Äôs intentions only" }
        ],
        explanation: "For pragmatists, meaning = practical consequences and use in inquiry."
      },
      {
        id: "q3",
        prompt: "Analytic philosophy‚Äôs ‚Äòconcept audit‚Äô aims to:",
        options: [
          { id: "A", text: "Add more metaphors" },
          { id: "B", text: "Uncover ambiguities and define decision rules", correct: true },
          { id: "C", text: "Ignore ordinary language" },
          { id: "D", text: "Replace experiments with introspection" }
        ],
        explanation: "Analytic methods clarify usage, surface ambiguities, and specify operational criteria."
      },
      {
        id: "q4",
        prompt: "In the ABCD lens, Beauty/Awe (B) matters because it:",
        options: [
          { id: "A", text: "Is merely decorative" },
          { id: "B", text: "Creates salience and future-pull, making control layers visible", correct: true },
          { id: "C", text: "Only applies to art" },
          { id: "D", text: "Prevents disciplined reasoning" }
        ],
        explanation: "Beauty/Awe directs attention and motivates sustained engagement."
      },
      {
        id: "q5",
        prompt: "A ‚Äòconstructor‚Äô in this module is best described as:",
        options: [
          { id: "A", text: "Any single person with expertise" },
          { id: "B", text: "A system that repeatedly produces a transformation and maintains that ability", correct: true },
          { id: "C", text: "A list of rules" },
          { id: "D", text: "A one-off project" }
        ],
        explanation: "Constructors repeatedly yield reliable outcomes and preserve the capacity to do so."
      },
      {
        id: "q6",
        prompt: "The ‚ÄòClaim ‚Üí Workflow Studio‚Äô primarily operationalizes which tradition?",
        options: [
          { id: "A", text: "Only phenomenology" },
          { id: "B", text: "Only analytic philosophy" },
          { id: "C", text: "Only philosophy of mind" },
          { id: "D", text: "A synthesis: concept audit + phenomenology + pragmatic testing", correct: true }
        ],
        explanation: "The studio integrates the three toolkits into a testable workflow."
      }
    ];

    // ---------- App ----------
    function App() {
      const [hasStarted, setHasStarted] = useState(false);
      const [student, setStudent] = useState({ name: "", email: "", course: "" });
      const [current, setCurrent] = useState("intro");
      const [session, setSession] = useState({ id: "", startedAt: "", completedAt: "" });

      const [progress, setProgress] = useState(() => {
        // per-section status and simple metrics
        const base = {};
        SECTIONS.forEach(s => base[s.id] = { status: "not-started", startedAt: null, endedAt: null, minutes: 0, interactions: 0 });
        return base;
      });

      // Phenomenology / Pragmatism / Analytic / Mind practice text
      const [notes, setNotes] = useState({
        pheno: "", prag: "", analytic: "", mind: ""
      });

      // Studio fields
      const [studio, setStudio] = useState({
        claim: "",
        auditAmbiguities: "",
        workingDefs: "",
        phenoNote: "",
        hypothesis: "",
        consequences: "",
        intervention: "",
        ethics: "",
        kpis: "",
        pilotNotes: "",
        abcdReflection: ""
      });

      // Quiz state
      const [answers, setAnswers] = useState({});
      const [quizSubmitted, setQuizSubmitted] = useState(false);
      const [quizScore, setQuizScore] = useState(0);

      // Load saved
      useEffect(() => {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return;
        try {
          const saved = JSON.parse(raw);
          if (saved) {
            setHasStarted(!!saved.hasStarted);
            setStudent(saved.student || { name: "", email: "", course: "" });
            setCurrent(saved.current || "intro");
            setSession(saved.session || { id: "", startedAt: "", completedAt: "" });
            setProgress(saved.progress || progress);
            setNotes(saved.notes || { pheno: "", prag: "", analytic: "", mind: "" });
            setStudio(saved.studio || studio);
            setAnswers(saved.answers || {});
            setQuizSubmitted(!!saved.quizSubmitted);
            setQuizScore(saved.quizScore || 0);
          }
        } catch (e) {}
        // eslint-disable-next-line
      }, []);

      // Save
      useEffect(() => {
        const payload = { hasStarted, student, current, session, progress, notes, studio, answers, quizSubmitted, quizScore };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
      }, [hasStarted, student, current, session, progress, notes, studio, answers, quizSubmitted, quizScore]);

      // Helpers
      const begin = (info) => {
        const id = generateSessionId();
        const now = new Date().toISOString();
        setStudent(info);
        setHasStarted(true);
        setSession({ id, startedAt: now, completedAt: "" });
        markStarted("intro");
      };

      const markStarted = (sec) => {
        setProgress(prev => {
          const p = { ...prev };
          if (p[sec].status === "not-started") {
            p[sec].status = "in-progress";
            p[sec].startedAt = new Date().toISOString();
          }
          p[sec].interactions += 1;
          return p;
        });
      };

      const markDone = (sec, level="proficient") => {
        setProgress(prev => {
          const p = { ...prev };
          const start = p[sec].startedAt ? new Date(p[sec].startedAt) : new Date();
          const end = new Date();
          const mins = Math.max(1, Math.round((end - start)/60000));
          p[sec].endedAt = end.toISOString();
          p[sec].minutes += mins;
          p[sec].status = level;
          return p;
        });
      };

      const goto = (sec) => {
        setCurrent(sec);
        markStarted(sec);
      };

      const resetAll = () => {
        if (!confirm("This will clear all saved progress for Part 12. Continue?")) return;
        localStorage.removeItem(STORAGE_KEY);
        window.location.reload();
      };

      const calcCourseProgress = () => {
        const total = SECTIONS.length;
        const done = Object.values(progress).filter(p => ["proficient","mastered","developing"].includes(p.status)).length;
        return Math.round((done/total)*100);
      };

      const submitQuiz = () => {
        let correct = 0;
        QUIZ.forEach(q => {
          const right = q.options.find(o => o.correct)?.id;
          if (answers[q.id] === right) correct += 1;
        });
        const pct = Math.round((correct / QUIZ.length) * 100);
        setQuizScore(pct);
        setQuizSubmitted(true);
        markDone("assessment", masteryFromPercent(pct));
        setSession(s => ({ ...s, completedAt: new Date().toISOString() }));
      };

      const completionText = () => {
        const pct = calcCourseProgress();
        const mastery = masteryFromPercent(quizScore || 0);
        const lines = [];
        lines.push("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");
        lines.push("PART 12: 20th-Century Turns ‚Äî Completion Document");
        lines.push("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");
        lines.push(`Student: ${student.name}  ‚Ä¢  ${student.email}  ‚Ä¢  ${student.course}`);
        lines.push(`Session: ${session.id}`);
        lines.push(`Started: ${session.startedAt}`);
        lines.push(`Completed: ${session.completedAt || "(in progress)"}`);
        lines.push("");
        lines.push(`Course Progress: ${pct}%`);
        lines.push(`Assessment Score: ${quizScore}%  ‚Üí  Mastery: ${mastery.toUpperCase()}`);
        lines.push("");
        lines.push("Section Status:");
        SECTIONS.forEach(s => {
          const st = progress[s.id];
          lines.push(` - ${s.label}: ${st.status} (${st.minutes} min, interactions: ${st.interactions})`);
        });
        lines.push("");
        lines.push("Studio Summary:");
        lines.push(`  Claim: ${studio.claim}`);
        lines.push(`  Working Definitions: ${studio.workingDefs}`);
        lines.push(`  Hypothesis: ${studio.hypothesis}`);
        lines.push(`  Consequences: ${studio.consequences}`);
        lines.push(`  Intervention: ${studio.intervention}`);
        lines.push(`  Ethics: ${studio.ethics}`);
        lines.push(`  KPIs: ${studio.kpis}`);
        lines.push(`  Pilot Notes: ${studio.pilotNotes}`);
        lines.push(`  ABCD Reflection: ${studio.abcdReflection}`);
        lines.push("");
        lines.push("This document was auto-generated by the Part 12 web module.");
        return lines.join("\n");
      };

      const downloadCompletion = () => {
        const blob = new Blob([completionText()], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `Part12-Completion-${(student.name||"student").replace(/\s+/g,"_")}.txt`;
        a.click();
      };

      // ---------- UI ----------
      if (!hasStarted) return (
        <Welcome onBegin={begin} />
      );

      const pct = calcCourseProgress();

      return (
        <div className="min-h-screen">
          {/* Header */}
          <header className="gradient-header text-white">
            <div className="max-w-7xl mx-auto px-4 py-6">
              <div className="flex items-start justify-between">
                <div>
                  <h1 className="text-3xl font-extrabold">Part 12 ‚Äî 20th-Century Turns</h1>
                  <p className="text-white/90">Phenomenology ‚Ä¢ Pragmatism ‚Ä¢ Analytic ‚Ä¢ Language & Mind</p>
                  <div className="mt-4 bg-white/20 rounded-full h-2 overflow-hidden">
                    <div className="progress-bar bg-white h-full" style={{ width: pct + "%" }}></div>
                  </div>
                  <p className="text-sm mt-2 text-white/90">{pct}% complete</p>
                </div>
                <div className="flex items-center gap-2">
                  <button onClick={resetAll} className="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-semibold">
                    Reset
                  </button>
                </div>
              </div>
            </div>
          </header>

          {/* Nav */}
          <nav className="bg-white shadow-sm sticky top-0 z-40">
            <div className="max-w-7xl mx-auto px-4">
              <div className="flex overflow-x-auto py-3 gap-2">
                {SECTIONS.map(sec => {
                  const st = progress[sec.id]?.status || "not-started";
                  const badge = masteryBadge(st);
                  const isCurrent = current === sec.id;
                  return (
                    <button key={sec.id} onClick={() => goto(sec.id)}
                      className={"px-4 py-2 rounded-lg border text-sm flex items-center gap-2 whitespace-nowrap " +
                        (isCurrent ? "bg-indigo-50 border-indigo-300 text-indigo-800"
                                   : "hover:bg-gray-50 border-gray-200 text-gray-700")}>
                      <span>{sec.icon}</span>
                      <span>{sec.label}</span>
                      <span className={"px-2 py-0.5 rounded-full " + badge.cls}>{badge.text}</span>
                    </button>
                  );
                })}
              </div>
            </div>
          </nav>

          {/* Content */}
          <main className="max-w-7xl mx-auto px-4 py-8">
            {current === "intro" && (
              <Intro onNext={() => { markDone("intro","proficient"); goto("phenomenology"); }} />
            )}

            {current === "phenomenology" && (
              <Panel
                title="I. Phenomenology ‚Äî Back to the Things Themselves"
                color="blue"
                body={
                  <>
                    <p className="text-gray-700 mb-4">
                      Phenomenology trains disciplined description of experience: <strong>epoch√©</strong> (bracketing),
                      <strong> intentionality</strong> (aboutness), embodiment, and the lifeworld.
                      Describe structures as they show themselves‚Äîbefore theorizing.
                    </p>
                    <ul className="list-disc list-inside text-gray-700 mb-4">
                      <li><strong>Capacity:</strong> attentional awareness.</li>
                      <li><strong>Capability:</strong> field-notes that track figure/ground, affordances, anticipations.</li>
                      <li><strong>Constructor:</strong> studio routines that repeatedly yield faithful descriptions.</li>
                      <li><strong>Meta-constructor:</strong> peer critique that improves descriptive norms.</li>
                    </ul>
                    <p className="text-gray-700">
                      <strong>Mini-practice:</strong> Observe a mug for 2 minutes. Write 150‚Äì200 words on
                      figure/ground, affordances, anticipations. No theory terms‚Äîjust structures.
                    </p>
                  </>
                }
                noteValue={notes.pheno}
                onNoteChange={(v) => setNotes(n => ({...n, pheno: v}))}
                onComplete={() => { markDone("phenomenology", "proficient"); goto("pragmatism"); }}
              />
            )}

            {current === "pragmatism" && (
              <Panel
                title="II. Pragmatism ‚Äî Inquiry as Problem-Solving"
                color="green"
                body={
                  <>
                    <p className="text-gray-700 mb-4">
                      Pragmatism treats ideas as tools. Frame a problem, form a hypothesis,
                      specify consequences, run a small intervention, and iterate.
                    </p>
                    <ul className="list-disc list-inside text-gray-700 mb-4">
                      <li><strong>Capacity:</strong> adaptive experimentation.</li>
                      <li><strong>Capability:</strong> hypothesis-to-test mapping.</li>
                      <li><strong>Constructor:</strong> lab/classroom cycles that produce reliable improvements.</li>
                      <li><strong>Meta-constructor:</strong> communities of inquiry that refine standards.</li>
                    </ul>
                    <p className="text-gray-700">
                      <strong>Mini-practice:</strong> Convert ‚ÄúOffice hours don‚Äôt help‚Äù into
                      Problem ‚Üí Hypothesis ‚Üí Consequence tests ‚Üí Small intervention.
                    </p>
                  </>
                }
                noteValue={notes.prag}
                onNoteChange={(v) => setNotes(n => ({...n, prag: v}))}
                onComplete={() => { markDone("pragmatism", "proficient"); goto("analytic"); }}
              />
            )}

            {current === "analytic" && (
              <Panel
                title="III. Analytic Philosophy ‚Äî Language, Logic, Conceptual Engineering"
                color="purple"
                body={
                  <>
                    <p className="text-gray-700 mb-4">
                      Make meanings explicit: conduct a <strong>concept audit</strong>, define terms operationally,
                      and sketch models. Use ordinary-language sensitivity or formal tools to prevent confusion.
                    </p>
                    <ul className="list-disc list-inside text-gray-700 mb-4">
                      <li>Uncover ambiguities and hidden presuppositions.</li>
                      <li>Specify decision rules that would settle a dispute.</li>
                      <li>Use counterexamples to stress-test a claim.</li>
                    </ul>
                    <p className="text-gray-700">
                      <strong>Mini-practice:</strong> Take ‚ÄúFree speech is absolute.‚Äù Provide 3 disambiguations of
                      ‚Äúabsolute,‚Äù 2 test cases, then a revised claim with explicit scope and decision rule.
                    </p>
                  </>
                }
                noteValue={notes.analytic}
                onNoteChange={(v) => setNotes(n => ({...n, analytic: v}))}
                onComplete={() => { markDone("analytic", "proficient"); goto("mind"); }}
              />
            )}

            {current === "mind" && (
              <Panel
                title="IV. Language & Mind ‚Äî Roles, Models, Context"
                color="indigo"
                body={
                  <>
                    <p className="text-gray-700 mb-4">
                      From behaviorism to functionalism to enactive hints: model mental states by the roles they play
                      in input‚Äìstate‚Äìoutput systems, while attending to context and embodiment.
                    </p>
                    <ul className="list-disc list-inside text-gray-700 mb-4">
                      <li>Box-and-arrow modeling (belief/desire ‚Üí predicted behavior).</li>
                      <li>Context switches as tests (sleep deprivation, group study).</li>
                      <li>Use mispredictions to refine the model.</li>
                    </ul>
                    <p className="text-gray-700">
                      <strong>Mini-practice:</strong> Model ‚ÄúStudent intends to pass the course.‚Äù Add two context
                      switches and predict behavior changes.
                    </p>
                  </>
                }
                noteValue={notes.mind}
                onNoteChange={(v) => setNotes(n => ({...n, mind: v}))}
                onComplete={() => { markDone("mind", "proficient"); goto("studio"); }}
              />
            )}

            {current === "studio" && (
              <Studio
                value={studio}
                onChange={setStudio}
                onComplete={() => { markDone("studio","mastered"); goto("assessment"); }}
                onDownloadPlan={() => {
                  const txt =
`Claim ‚Üí Workflow (Part 12)

Claim:
${studio.claim}

Concept Audit ‚Äî Ambiguities:
${studio.auditAmbiguities}

Working Definitions:
${studio.workingDefs}

Phenomenology Field-Note:
${studio.phenoNote}

Hypothesis:
${studio.hypothesis}

Observable Consequences:
${studio.consequences}

Intervention Plan:
${studio.intervention}

Ethics & Context Check:
${studio.ethics}

KPIs:
${studio.kpis}

Pilot Notes:
${studio.pilotNotes}

ABCD Reflection:
${studio.abcdReflection}
`;
                  const blob = new Blob([txt], { type: "text/plain" });
                  const url = URL.createObjectURL(blob);
                  const a = document.createElement("a");
                  a.href = url;
                  a.download = "Part12-Claim-to-Workflow.txt";
                  a.click();
                }}
              />
            )}

            {current === "assessment" && (
              <Assessment
                quiz={QUIZ}
                answers={answers}
                onAnswer={(qid, optId) => setAnswers(prev => ({ ...prev, [qid]: optId }))}
                onSubmit={submitQuiz}
                submitted={quizSubmitted}
                score={quizScore}
                onNext={() => goto("completion")}
              />
            )}

            {current === "completion" && (
              <Completion
                student={student}
                session={session}
                progress={progress}
                score={quizScore}
                onDownload={downloadCompletion}
                docText={completionText()}
              />
            )}
          </main>
        </div>
      );
    }

    // ---------- Components ----------
    function Welcome({ onBegin }) {
      const [form, setForm] = useState({ name: "", email: "", course: "" });
      const ready = form.name && form.email && form.course;
      return (
        <div className="min-h-screen gradient-header text-white">
          <div className="max-w-3xl mx-auto px-4 py-12">
            <div className="bg-white/10 backdrop-blur rounded-2xl p-8 shadow-xl">
              <h1 className="text-3xl font-extrabold mb-2">Part 12 ‚Äî 20th-Century Turns</h1>
              <p className="text-white/90 mb-6">Phenomenology ‚Ä¢ Pragmatism ‚Ä¢ Analytic ‚Ä¢ Language & Mind</p>
              <div className="bg-white rounded-xl text-gray-800 p-6">
                <h2 className="text-xl font-bold mb-3">Orientation</h2>
                <p className="mb-3">This module treats three families of practice as toolkits:
                  <strong> phenomenology</strong> (disciplined description),
                  <strong> pragmatism</strong> (inquiry cycles), and
                  <strong> analytic philosophy</strong> (conceptual engineering),
                  plus <strong>language & mind</strong> modeling.
                </p>
                <p className="mb-3">You‚Äôll produce small artifacts and a reusable
                  <em> Claim ‚Üí Workflow</em> plan that turns philosophical claims into testable inquiries.
                </p>
              </div>

              <form className="mt-6 grid md:grid-cols-3 gap-3"
                    onSubmit={(e) => { e.preventDefault(); if (ready) onBegin(form); }}>
                <input className="px-4 py-2 rounded-md text-gray-900" placeholder="Full Name"
                       value={form.name} onChange={e => setForm(f => ({...f, name: e.target.value}))} />
                <input className="px-4 py-2 rounded-md text-gray-900" placeholder="Email"
                       value={form.email} onChange={e => setForm(f => ({...f, email: e.target.value}))} />
                <input className="px-4 py-2 rounded-md text-gray-900" placeholder="Course/Section"
                       value={form.course} onChange={e => setForm(f => ({...f, course: e.target.value}))} />
                <button type="submit"
                        className={"md:col-span-3 mt-2 px-4 py-2 rounded-md font-semibold " + (ready ? "bg-white text-indigo-700 hover:bg-indigo-50" : "bg-white/50 text-white/70 cursor-not-allowed")}>
                  Begin Part 12 ‚Üí
                </button>
              </form>
            </div>
          </div>
        </div>
      );
    }

    function Panel({ title, color, body, noteValue, onNoteChange, onComplete }) {
      const colorBox = {
        blue: "border-blue-200 bg-blue-50",
        green: "border-green-200 bg-green-50",
        purple: "border-purple-200 bg-purple-50",
        indigo: "border-indigo-200 bg-indigo-50"
      }[color] || "border-gray-200 bg-gray-50";

      return (
        <div className="bg-white rounded-xl shadow p-6">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">{title}</h2>
          <div className={"rounded-lg border p-4 mb-4 " + colorBox}>
            {body}
          </div>
          <label className="block text-sm font-semibold text-gray-700 mb-2">Your practice note (min 120 chars):</label>
          <textarea rows="6" className="w-full border rounded-md p-3"
                    placeholder="Write your field-note / plan / model sketch here..."
                    value={noteValue}
                    onChange={(e) => onNoteChange(e.target.value)} />
          <div className="mt-3 flex justify-end">
            <button
              onClick={() => onComplete()}
              disabled={(noteValue||"").trim().length < 120}
              className={"px-4 py-2 rounded-md font-semibold " + ((noteValue||"").trim().length >= 120 ? "bg-indigo-600 text-white hover:bg-indigo-700" : "bg-gray-200 text-gray-500 cursor-not-allowed")}>
              Mark Complete & Continue ‚Üí
            </button>
          </div>
        </div>
      );
    }

    function Studio({ value, onChange, onComplete, onDownloadPlan }) {
      const set = (k, v) => onChange({ ...value, [k]: v });
      const fields = [
        { id: "claim", label: "Step 0 ‚Äî Claim (single sentence you care about)" },
        { id: "auditAmbiguities", label: "Step 1 ‚Äî Concept Audit: Ambiguities & Presuppositions (list 2‚Äì3)" },
        { id: "workingDefs", label: "Step 1 ‚Äî Working Definitions (bullet 2‚Äì3 you will use THIS run)" },
        { id: "phenoNote", label: "Step 2 ‚Äî Phenomenology Field-Note (120‚Äì150 words, no theory terms)" },
        { id: "hypothesis", label: "Step 3 ‚Äî Hypothesis (If claim true, we should observe‚Ä¶)" },
        { id: "consequences", label: "Step 3 ‚Äî Observable Consequences (at least one behavioral, one attentional)" },
        { id: "intervention", label: "Step 3 ‚Äî Minimal Intervention Plan (pilotable in class)" },
        { id: "ethics", label: "Step 4 ‚Äî Context & Ethics Check (accessibility, risk, fairness)" },
        { id: "kpis", label: "Step 5 ‚Äî KPIs (fit-for-purpose indicators, thresholds)" },
        { id: "pilotNotes", label: "Step 6 ‚Äî Pilot Notes (anomalies, surprises, design changes)" },
        { id: "abcdReflection", label: "Step 7 ‚Äî ABCD Reflection (Agency, Beauty/Awe, Context, Dynamics)" }
      ];

      const ready = value.claim && value.workingDefs && value.hypothesis && value.consequences && value.intervention && value.kpis;

      return (
        <div className="bg-white rounded-xl shadow p-6">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">V. Claim ‚Üí Workflow Studio</h2>
          <p className="text-gray-700 mb-4">
            Turn a philosophical claim into a testable inquiry workflow by chaining concept audit, phenomenology, and pragmatic testing.
          </p>

          <div className="grid md:grid-cols-2 gap-4">
            {fields.map(f => (
              <div key={f.id} className="border rounded-lg p-3 bg-gray-50">
                <label className="block text-sm font-semibold text-gray-700 mb-2">{f.label}</label>
                <textarea rows="6" className="w-full border rounded-md p-2"
                  value={value[f.id]} onChange={(e) => set(f.id, e.target.value)} />
              </div>
            ))}
          </div>

          <div className="mt-4 flex flex-col md:flex-row gap-3 justify-end">
            <button onClick={onDownloadPlan} className="px-4 py-2 rounded-md bg-white border text-gray-700 hover:bg-gray-50">
              ‚¨áÔ∏è Download Plan (.txt)
            </button>
            <button
              onClick={onComplete}
              disabled={!ready}
              className={"px-4 py-2 rounded-md font-semibold " + (ready ? "bg-indigo-600 text-white hover:bg-indigo-700" : "bg-gray-200 text-gray-500 cursor-not-allowed")}>
              Mark Studio Complete & Continue ‚Üí
            </button>
          </div>
        </div>
      );
    }

    function Assessment({ quiz, answers, onAnswer, onSubmit, submitted, score, onNext }) {
      const allAnswered = quiz.every(q => !!answers[q.id]);

      return (
        <div className="bg-white rounded-xl shadow p-6">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">VI. Assessment</h2>
          <p className="text-gray-700 mb-6">Answer the questions below. Immediate explanations appear after submit.</p>

          <div className="space-y-6">
            {quiz.map((q, idx) => {
              const selected = answers[q.id];
              const right = q.options.find(o => o.correct)?.id;
              return (
                <div key={q.id} className="border rounded-lg p-4">
                  <h3 className="font-semibold text-gray-900 mb-2">Q{idx+1}. {q.prompt}</h3>
                  <div className="grid gap-2">
                    {q.options.map(opt => {
                      const isChosen = selected === opt.id;
                      const isCorrect = !!opt.correct;
                      const base = "text-left w-full border rounded-md p-3";
                      let cls = "border-gray-300 hover:bg-gray-50";
                      if (submitted && isChosen && isCorrect) cls = "border-green-500 bg-green-50";
                      if (submitted && isChosen && !isCorrect) cls = "border-red-500 bg-red-50";
                      if (submitted && !isChosen && isCorrect) cls = "border-green-400 bg-green-50";
                      return (
                        <button key={opt.id}
                          disabled={submitted}
                          onClick={() => onAnswer(q.id, opt.id)}
                          className={`${base} ${cls}`}>
                          <span className="font-bold mr-2">{opt.id}.</span>{opt.text}
                        </button>
                      );
                    })}
                  </div>
                  {submitted && (
                    <div className={"mt-3 p-3 rounded-md " + (answers[q.id] === right ? "bg-green-50 border border-green-200" : "bg-red-50 border border-red-200")}>
                      <p className="text-sm text-gray-800"><strong>Explanation:</strong> {q.explanation}</p>
                    </div>
                  )}
                </div>
              );
            })}
          </div>

          {!submitted ? (
            <div className="mt-6 flex justify-end">
              <button
                onClick={onSubmit}
                disabled={!allAnswered}
                className={"px-4 py-2 rounded-md font-semibold " + (allAnswered ? "bg-indigo-600 text-white hover:bg-indigo-700" : "bg-gray-200 text-gray-500 cursor-not-allowed")}>
                Submit Assessment
              </button>
            </div>
          ) : (
            <div className="mt-6 flex items-center justify-between bg-indigo-50 border border-indigo-200 rounded-lg p-4">
              <div>
                <p className="text-indigo-900 font-semibold">Your score: {score}%</p>
                <p className="text-indigo-800 text-sm">Mastery: {masteryFromPercent(score)}</p>
              </div>
              <button onClick={onNext} className="px-4 py-2 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">
                View Completion Doc ‚Üí
              </button>
            </div>
          )}
        </div>
      );
    }

    function Completion({ student, session, progress, score, onDownload, docText }) {
      const totalMin = Object.values(progress).reduce((acc, s) => acc + (s.minutes||0), 0);
      const mastery = masteryFromPercent(score);
      return (
        <div id="printable" className="bg-white rounded-xl shadow p-6">
          <h2 className="text-2xl font-bold text-gray-900 mb-4">VII. Completion Document</h2>
          <div className="grid md:grid-cols-3 gap-4 mb-4">
            <div className="bg-gray-50 rounded-lg p-4">
              <div className="text-gray-500 text-sm">Student</div>
              <div className="font-semibold">{student.name}</div>
              <div className="text-sm text-gray-700">{student.email}</div>
              <div className="text-sm text-gray-700">{student.course}</div>
            </div>
            <div className="bg-gray-50 rounded-lg p-4">
              <div className="text-gray-500 text-sm">Session</div>
              <div className="text-sm text-gray-700">ID: {session.id}</div>
              <div className="text-sm text-gray-700">Start: {session.startedAt}</div>
              <div className="text-sm text-gray-700">Complete: {session.completedAt || "(in progress)"}</div>
            </div>
            <div className="bg-gray-50 rounded-lg p-4">
              <div className="text-gray-500 text-sm">Summary</div>
              <div className="text-sm text-gray-700">Assessment: <strong>{score}%</strong></div>
              <div className="text-sm text-gray-700">Mastery: <strong>{mastery}</strong></div>
              <div className="text-sm text-gray-700">Time on task: <strong>{totalMin} min</strong></div>
            </div>
          </div>

          <div className="overflow-auto border rounded-lg">
            <pre className="whitespace-pre-wrap text-sm p-4">{docText}</pre>
          </div>

          <div className="mt-4 flex flex-col md:flex-row gap-3 justify-end">
            <button onClick={onDownload} className="px-4 py-2 rounded-md bg-white border text-gray-700 hover:bg-gray-50">
              ‚¨áÔ∏è Download (.txt)
            </button>
            <button onClick={() => window.print()} className="px-4 py-2 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">
              üñ®Ô∏è Print
            </button>
          </div>
        </div>
      );
    }

    // ---------- Mount ----------
    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
